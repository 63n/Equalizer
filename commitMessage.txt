Templatize compression entry point

[ ] Will break Win32 build
[ ] Breaks existing applications
[ ] Bugfix
[x] New Feature
[x] Cleanup
[ ] Optimization
[ ] Documentation
